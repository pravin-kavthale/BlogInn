{% extends 'blog/base.html' %}
{% load static %} {# Load static to use MEDIA_URL for the image #}

{% block content %}
<div class="min-h-screen bg-[#1a1a2e] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full mx-auto mt-12 bg-[#74a3ba] p-8 rounded-2xl shadow-lg text-center font-sans">
        <div class="bg-[#FFF4D4] rounded-full w-24 h-24 mx-auto mb-5 flex items-center justify-center overflow-hidden">
            {# Ensure MEDIA_URL is correctly defined in settings and served in urls.py for development #}
            <img src="{{ MEDIA_URL }}logo/lock-icon.jpg" alt="Lock Icon" class="w-24 h-24 rounded-full object-cover">
        </div>

        <h2 class="text-3xl font-semibold mb-3 text-white">Reset Your Password?</h2>
        <p class="text-sm text-gray-200 leading-relaxed mb-6">Both passwords should match.</p>

        <form method="POST" class="space-y-5">
            {% csrf_token %}

            {# Non-field errors using Tailwind CSS #}
            {% if form.non_field_errors %}
                <div class="bg-red-500 text-white px-4 py-3 rounded relative mb-4" role="alert">
                    <strong class="font-bold">Error!</strong>
                    <span class="block sm:inline">{{ form.non_field_errors }}</span>
                    <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentElement.style.display='none';">
                        <svg class="fill-current h-6 w-6 text-white" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.103l-2.651 3.746a1.2 1.2 0 1 1-1.697-1.697l3.746-2.651-3.746-2.651a1.2 1.2 0 0 1 1.697-1.697L10 8.897l2.651-3.746a1.2 1.2 0 1 1 1.697 1.697L11.103 10l3.746 2.651a1.2 1.2 0 0 1 0 1.698z"/></svg>
                    </span>
                </div>
            {% endif %}

            {% for field in form %}
                <div>
                    {# Label for accessibility, hidden visually #}
                    <label for="{{ field.id_for_label }}" class="sr-only">{{ field.label }}</label>
                    <input type="{{ field.widget.input_type }}" name="{{ field.name }}" id="{{ field.id_for_label }}"
                           class="w-full px-4 py-3 border border-gray-300 rounded-full bg-[#F0F0F4] text-gray-900 text-sm
                                  placeholder-gray-900 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                           placeholder="{{ field.label }}" {# Use field label as placeholder #}
                           value="{{ field.value|default_if_none:'' }}">
                    {% if field.errors %}
                        <div class="text-red-600 text-xs mt-1 text-left">
                            {% for error in field.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            {% endfor %}

            <button type="submit"
                    class="bg-transparent border-2 border-[#F9F5EF] text-gray-100 font-bold px-6 py-2.5 rounded-xl cursor-pointer
                           transition duration-300 ease-in-out hover:bg-[#DB8A71] hover:text-white
                           focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
                Change PASSWORD
            </button>
        </form>
    </div>
</div>

<script>
    // JavaScript to hide errors on input focus/change (optional but good UX)
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');
        if (form) {
            form.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', function() {
                    const errorDiv = this.parentElement.querySelector('.text-red-600');
                    if (errorDiv) {
                        errorDiv.style.display = 'none';
                    }
                    // Also hide non-field errors if any input changes
                    const nonFieldErrors = form.querySelector('[role="alert"]');
                    if (nonFieldErrors) {
                        nonFieldErrors.style.display = 'none';
                    }
                });
            });
        }
    });
</script>
{% endblock %}